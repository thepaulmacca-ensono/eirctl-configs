contexts:
  powershell:
    container:
      name: ensono/eir-infrastructure
      shell: pwsh
      shell_args:
        - -Command
    envfile:
      exclude:
        - sourceversionmessage
        - posh_azure_subscription

tasks:
  scan:terraform:checkov:
    context: powershell
    description: Perform Terraform Static Code Analysis using Checkov
    command:
      - |
        Write-Host ("Path: {0}" -f $env:TF_FILE_LOCATION)

        checkov -d $env:TF_FILE_LOCATION -o cli -o junitxml --output-file-path console,results.xml
